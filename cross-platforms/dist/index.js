!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MetrixInAppApi={})}(this,(function(e){"use strict";class t{}const o="center_modal",i=!0;class n extends t{initialize(){window.onload=()=>{this.postMessageToNative({type:"rendering_complete",pageMetaData:this.getPageMetaData(),displayLocation:o,dragToDismissDisabled:!i})},window.onresize=()=>{this.postMessageToNative({type:"resize",pageMetaData:this.getPageMetaData(),displayLocation:o})}}close(){this.actionTaken({close:!0})}openUrl(e){this.actionTaken({action:{action_type:"U",url:e},close:!0})}sendEvent(e,t){this.newEvent(e,t)}sendResponse(e){const t=window.id;if(!t)throw Error("Campaign id not found");this.postMessageToNative({type:"send_response",campaignId:t,attributes:e?JSON.stringify(e):void 0})}postMessageToNative(e){console.log("postMessageToNative(): "+JSON.stringify(e));let t=JSON.stringify(e);if(!window.MetrixInAppBridge)throw Error("Metrix in-app bridge not found");window.MetrixInAppBridge.postMessage(t)}getPageMetaData(){const e=document.body.scrollHeight;return console.log("height:",e),{rect:{height:e}}}actionTaken(e){console.log("actionTaken(): "+e),this.postMessageToNative({type:"action_taken",body:e})}newEvent(e,t){if(!window.MetrixAnalyticsBridge)throw Error("Metrix analytic bridge not found");window.MetrixAnalyticsBridge.newEvent(e,t?JSON.stringify(t):void 0)}}var s=(e=>(e.CLOSE_ONSITE="CLOSE_ONSITE",e.OPEN_URL="OPEN_URL",e.SEND_EVENT="SEND_EVENT",e.SEND_RESPONSE="SEND_RESPONSE",e))(s||{});class d extends t{initialize(){window.addEventListener("message",(e=>{var t,o;if("getDimensions"===(null==(t=e.data)?void 0:t.type)&&(null==(o=e.data)?void 0:o.id)===window.id){const e=document.body.scrollHeight,t=document.body.scrollWidth,o={id:window.id,type:"SCALE_IFRAME",payload:{width:t,height:e}};window.parent.postMessage(o,"*")}}))}close(){const e={type:s.CLOSE_ONSITE,id:window.id};window.parent.postMessage(e,"*")}openUrl(e){const t={type:s.OPEN_URL,payload:e,id:window.id};window.parent.postMessage(t,"*")}sendEvent(e,t){const o={type:s.SEND_EVENT,id:window.id,payload:{slug:e,attributes:t}};window.parent.postMessage(o,"*")}sendResponse(e){const t={type:s.SEND_RESPONSE,id:window.id,payload:{payload:e}};window.parent.postMessage(t,"*")}}let a;window.MetrixInAppBridge?(a=new n,console.log("Android")):(a=new d,console.log("Web")),a.initialize(),e.close=function(){a.close()},e.openUrl=function(e){if(!e)throw Error("Url is not provided inside openUrl method");a.openUrl(e)},e.sendEvent=function(e,t){if(!e)throw Error("Slug of event is not provided inside sendEvent method");a.sendEvent(e,t)},e.sendResponse=function(e){a.sendResponse(e)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
